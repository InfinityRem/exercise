{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ESL\\\\Desktop\\\\AS\\\\picasso-test-task-main\\\\src\\\\entities\\\\Posts\\\\ui\\\\Posts.tsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { postApi } from \"../api/postsApi\";\nimport { PostItem } from \"../../../widgets/Post/ui/PostItem\";\nimport style from './Posts.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Posts = () => {\n  _s();\n  const [currentPostStart, setCurrentPostStart] = useState(0);\n  const {\n    data: posts,\n    isLoading\n  } = postApi.useFetchAllPostsQuery({\n    limit: 7,\n    start: currentPostStart\n  });\n  const [isMyFetching, setIsFetchingDown] = useState(false);\n  const [isMyFetchingUp, setIsMyFetchingUp] = useState(false);\n  useEffect(() => {\n    if (isMyFetching) {\n      setCurrentPostStart(prev => {\n        return prev < 93 ? prev + 1 : prev;\n      });\n      setIsFetchingDown(false);\n    }\n  }, [isMyFetching]);\n  useEffect(() => {\n    if (isMyFetchingUp) {\n      setCurrentPostStart(prev => {\n        return prev > 0 ? prev - 1 : prev;\n      });\n      setIsMyFetchingUp(false);\n    }\n  }, [isMyFetchingUp]);\n  useEffect(() => {\n    document.addEventListener('scroll', scrollHandler);\n    return () => {\n      document.removeEventListener('scroll', scrollHandler);\n    };\n  }, []);\n  const scrollHandler = e => {\n    if (e.target.documentElement.scrollTop < 50) {\n      setIsMyFetchingUp(true);\n    }\n    if (e.target.documentElement.scrollHeight - e.target.documentElement.scrollTop - window.innerHeight < 50) {\n      setIsFetchingDown(true);\n      window.scrollTo(0, e.target.documentElement.scrollHeight + e.target.documentElement.scrollTop);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: style.container,\n      children: posts === null || posts === void 0 ? void 0 : posts.map(post => /*#__PURE__*/_jsxDEV(PostItem, {\n        post: post\n      }, post.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 29\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 21\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 7\n  }, this);\n};\n_s(Posts, \"FWdDIjaXX+cSLtGlACP885XK8V0=\", false, function () {\n  return [postApi.useFetchAllPostsQuery];\n});\n_c = Posts;\nvar _c;\n$RefreshReg$(_c, \"Posts\");","map":{"version":3,"names":["useEffect","useState","postApi","PostItem","style","jsxDEV","_jsxDEV","Posts","_s","currentPostStart","setCurrentPostStart","data","posts","isLoading","useFetchAllPostsQuery","limit","start","isMyFetching","setIsFetchingDown","isMyFetchingUp","setIsMyFetchingUp","prev","document","addEventListener","scrollHandler","removeEventListener","e","target","documentElement","scrollTop","scrollHeight","window","innerHeight","scrollTo","children","className","container","map","post","id","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ESL/Desktop/AS/picasso-test-task-main/src/entities/Posts/ui/Posts.tsx"],"sourcesContent":["import {FC, useEffect, useState} from \"react\";\nimport {postApi} from \"../api/postsApi\";\nimport {PostItem} from \"../../../widgets/Post/ui/PostItem\";\nimport style from './Posts.module.scss'\n\nexport const Posts: FC = () => {\n  const [currentPostStart,setCurrentPostStart]=useState(0)\n  const {data:posts, isLoading} =postApi.useFetchAllPostsQuery({limit:7,start:currentPostStart})\n  const [isMyFetching,setIsFetchingDown]=useState(false)\n  const [isMyFetchingUp,setIsMyFetchingUp]=useState(false)\n\n  useEffect(()=>{\n    if(isMyFetching)\n    {\n      setCurrentPostStart(prev=>{\n        return prev<93?prev+1:prev\n      })\n      setIsFetchingDown(false)\n    }\n  },[isMyFetching])\n  useEffect(()=>{\n    if(isMyFetchingUp)\n    {\n      setCurrentPostStart(prev=>{\n        return prev>0?prev-1:prev\n      })\n      setIsMyFetchingUp(false)\n    }\n  },[isMyFetchingUp])\n  useEffect(()=>{\n    document.addEventListener('scroll',scrollHandler)\n    return ()=>{\n      document.removeEventListener('scroll',scrollHandler)\n    }\n  },[])\n  const scrollHandler=(e:any):void=>{\n    if(e.target.documentElement.scrollTop<50)\n    {\n      setIsMyFetchingUp(true)\n    }\n    if(e.target.documentElement.scrollHeight-e.target.documentElement.scrollTop-window.innerHeight<50)\n    {\n      setIsFetchingDown(true)\n      window.scrollTo(0,(e.target.documentElement.scrollHeight + e.target.documentElement.scrollTop));\n    }\n  }\n  return (\n      <div>\n        <div className={style.container}>\n          {posts?.map(post=><PostItem key={post.id} post={post}/>)}\n        </div>\n        {isLoading&&<div>Загрузка данных</div>}\n      </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}